# Node 0 starts first, and wins the first election
start_node
periodic_one,0,110
dispatch_all

# Add two more nodes
trust_node,1,1
trust_node,1,2
emit_signature,1
periodic_all,10
dispatch_all

# Commit reconfiguration
periodic_all,10
dispatch_all

# Three node network is ready
assert_is_primary,0
assert_is_backup,1
assert_is_backup,2
assert_state_sync

replicate,1,helloworld
emit_signature,1
periodic_all,10
dispatch_all
periodic_all,1
state_all

periodic_all,10
dispatch_all

periodic_all,10
dispatch_all

state_all
assert_state_sync
